(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{112:function(e,t,n){"use strict";var a=n(29),r=n(27),i=n(90),o=n(7),s=n(191),c=n.n(s),u=function(e){var t=e.type,n=void 0===t?"info":t,a=e.text,r=e.timeout;if(!r)switch(n){case"warning":case"error":r=5e3;break;case"success":case"info":default:r=3e3}var i={id:c()({length:6}).toLowerCase(),type:n,text:a,timeout:r};return function(e){e(o.b(i)),setTimeout(function(){e(o.f(i.id))},r)}},l=n(17),d=n(83);n.d(t,"a",function(){return m});var p,f=new d.a("SipCaller"),m=function(){function e(){Object(a.a)(this,e),f.debug("constructor()"),this._ua=null,this._init()}return Object(r.a)(e,null,[{key:"init",value:function(e){p=e.store}}]),Object(r.a)(e,[{key:"_init",value:function(){f.debug("_init()"),p.getState().user.autoRegister&&this.register()}},{key:"register",value:function(){var e=this;f.debug("register()");var t=p.getState().user,n=t.displayName,a=t.sipUri,r=t.password,s=t.outboundProxy,c=window.iceServers;p.dispatch(o.m()),this._ua=new i.UA({uri:a,password:r,displayName:n,transportOptions:{wsServers:[s],traceSip:!0},sessionDescriptionHandlerFactoryOptions:{peerConnectionOptions:{rtcConfiguration:{iceServers:c}}}}),this._ua.on("registered",function(){f.debug("Registered"),p.dispatch(u({type:"success",text:"Successfully registered."})),p.dispatch(o.o({registrationMessage:"Success"})),p.dispatch(o.n({registered:!0}))}),this._ua.on("registrationFailed",function(e,t){f.debug("Registration failed [cause: %s]",t),p.dispatch(u({type:"error",text:"Registration failed: ".concat(t)})),p.dispatch(o.o({registrationMessage:t})),p.dispatch(o.n({registered:!1}))}),this._ua.on("unregistered",function(e,t){f.debug("Unregistered [cause: %s]",t),p.dispatch(u({text:"Unregistered: ".concat(t)})),p.dispatch(o.o({registrationMessage:t})),p.dispatch(o.n({registered:!1}))}),this._ua.on("invite",function(t){f.debug("Incoming invite [sipSession: %o]",t),p.dispatch(u({text:"Incoming call from: ".concat(t.remoteIdentity.uri.user)})),e._handleSession(t,l.d)})}},{key:"unRegister",value:function(){f.debug("unRegister()"),this._ua.unregister()}},{key:"_handleSession",value:function(e,t){var n=this;f.debug("_handleSession() [sipSession: %o]",e);var a=Date.now();e.on("trackAdded",function(){f.debug("SipSession trackAdded [sipSession: %o]",e);var t=e.sessionDescriptionHandler.peerConnection,n=new MediaStream;t.getReceivers().forEach(function(e){e.track&&n.addTrack(e.track)}),p.dispatch(o.c({sipSession:e,remoteStream:n}));var a=new MediaStream;t.getSenders().forEach(function(e){e.track&&a.addTrack(e.track)}),p.dispatch(o.a({sipSession:e,localStream:a}))}),e.on("replaced",function(a){f.debug("SipSession replaced [oldSipSession: %o, newSipSession: %o]",e,a),n._handleSession(a,t)}),e.on("referRequested",function(t){t instanceof i.ReferClientContext&&(t.on("referRequestAccepted",function(){p.dispatch(o.q({sipSession:e,sessionState:l.h}))}),t.on("referRequestRejected",function(){p.dispatch(o.q({sipSession:e,sessionState:l.i}))})),t instanceof i.ReferServerContext&&t.accept()}),e.on("directionChanged",function(){"sendrecv"===e.sessionDescriptionHandler.getDirection()?f.debug("SipSession not on hold [sipSession: %o]",e):f.debug("SipSession on hold [sipSession: %o]",e)}),e.on("progress",function(t){f.debug("SipSession progress [response: %o, sipSession: %o]",t,e),p.dispatch(o.q({sipSession:e,sessionState:l.g}))}),e.on("accepted",function(t){f.debug("SipSession accepted [data: %o, sipSession: %o]",t,e),p.dispatch(o.q({sipSession:e,sessionState:l.a}))}),e.on("bye",function(t){f.debug("SipSession bye [request: %o, sipSession: %o]",t,e),p.dispatch(o.q({sipSession:e,sessionState:l.k}))}),e.on("cancel",function(){f.debug("SipSession canceled [sipSession: %o]",e),p.dispatch(o.q({sipSession:e,sessionState:l.b}))}),e.on("rejected",function(t,n){f.debug("SipSession rejected [response: %o, cause: %s, sipSession: %o]",t,n,e),p.dispatch(o.q({sipSession:e,sessionState:l.j}))}),e.on("failed",function(t,n){f.debug("SipSession failed [response: %o, cause: %s, sipSession: %o]",t,n,e),p.dispatch(o.q({sipSession:e,sessionState:l.c}))}),e.on("terminated",function(t,n){f.debug("SipSession terminated [message: %o, cause: %s, sipSession: %o]",t,n,e),p.dispatch(u({text:"Call terminated: ".concat(e.remoteIdentity.uri.user)})),p.dispatch(o.q({sipSession:e,sessionState:l.k}));var r=e.remoteIdentity.displayName||e.remoteIdentity.uri.user,i=e.remoteIdentity.uri.toString();p.dispatch(o.e({displayName:r,sipUri:i,startTime:a})),setTimeout(function(){if(f.debug("SipSession removed [sipSession: %o]",e),p.dispatch(o.g({sipSession:e})),!p.getState().userStatus.currentSession){var t=p.getState().sessions;t&&p.dispatch(o.i({currentSession:Object.keys(t)[0]}))}},3e3)}),p.dispatch(o.d({sipSession:e,direction:t}))}},{key:"accept",value:function(e){f.debug("accept() [sipSession: %o]",e);var t=p.getState().user.videoEnabled;e.accept({sessionDescriptionHandlerOptions:{constraints:{audio:!0,video:t}}})}},{key:"terminate",value:function(e){f.debug("terminate() [sipSession: %o]",e),e.terminate()}},{key:"invite",value:function(e){f.debug("invite() [sipUri: %s]",e);var t=p.getState().user.videoEnabled,n=this._ua.invite(e,{sessionDescriptionHandlerOptions:{constraints:{audio:!0,video:t}}});this._handleSession(n,l.f),p.dispatch(o.i({currentSession:n.request.callId}))}},{key:"refer",value:function(e,t){f.debug("refer() [sipSession: %o, sipUri: %s]",e,t),e.refer(t)}},{key:"toggleMedia",value:function(e,t,n){f.debug("toggleMedia() [sipSession: %o, type: %s, mute: %s]",e,t,n);var a=e.request.callId,r=p.getState().sessions[a].remoteStream;if(r)if("audio"===t)r.getAudioTracks()[0].enabled=!n,p.dispatch(o.t({sipSession:e}));else{if("video"!==t)throw new Error("Unknown media type.");r.getVideoTracks()[0].enabled=!n,p.dispatch(o.u({sipSession:e}))}}},{key:"toggleMyMedia",value:function(e,t,n){if(f.debug("toggleMyMedia() [session: %o, type: %s, mute: %s]",e,t,n),"audio"===t)e.localStream.getAudioTracks()[0].enabled=!n;else{if("video"!==t)throw new Error("Unknown media type.");e.localStream.getVideoTracks()[0].enabled=!n}}}]),e}()},17:function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"g",function(){return r}),n.d(t,"j",function(){return i}),n.d(t,"a",function(){return o}),n.d(t,"b",function(){return s}),n.d(t,"c",function(){return c}),n.d(t,"k",function(){return u}),n.d(t,"h",function(){return l}),n.d(t,"i",function(){return d}),n.d(t,"d",function(){return p}),n.d(t,"f",function(){return f});var a=Symbol("NEW"),r=Symbol("PROGRESS"),i=Symbol("REJECTED"),o=(Symbol("IGNORED"),Symbol("ACCEPTED")),s=Symbol("CANCELED"),c=Symbol("FAILED"),u=Symbol("TERMINATED"),l=(Symbol("REFERRED"),Symbol("REFER_REQUEST_ACCEPTED")),d=Symbol("REFER_REQUEST_REJECTED"),p=(Symbol("REFER_PROGRESS"),Symbol("REFER_ACCEPTED"),Symbol("REFER_REJECTED"),Symbol("INCOMING")),f=Symbol("OUTGOING")},189:function(e,t,n){"use strict";var a=n(0),r=n.n(a);n(377);t.a=function(){return r.a.createElement("div",{className:"LoadingView"})}},190:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function r(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("","/service-worker.js");a?(!function(e,t){fetch(e).then(function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):i(e,t)}).catch(function(){})}(t,e),navigator.serviceWorker.ready.then(function(){})):i(t,e)})}}function i(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?t&&t.onUpdate&&t.onUpdate(e):t&&t.onSuccess&&t.onSuccess(e))})}}).catch(function(){})}},192:function(e,t,n){"use strict";var a=n(29),r=n(27),i=n(45),o=n(44),s=n(46),c=n(31),u=n(0),l=n.n(u),d=n(21),p=n(20),f=n(185),m=n.n(f),S=n(186),E=n.n(S),h=n(18),g=n.n(h),b=n(36),y=n.n(b),v=n(107),O=n.n(v),R=n(89),_=n.n(R),T=n(188),w=n.n(T),I=n(106),C=n.n(I),j=n(110),k=n.n(j),N=n(108),A=n.n(N),M=n(109),U=n.n(M),D=n(187),x=n.n(D),P=n(30),G=n(7),L=n(34),q=n.n(L),V=n(24),W=n.n(V),F=n(28),H=n.n(F),z=n(49),B=n.n(z),Y=n(170),J=n.n(Y),Q=n(171),X=n.n(Q),K=Object(P.b)(Object(d.b)(function(e){return{displayName:e.user.displayName,sipUri:e.user.sipUri,password:e.user.password,outboundProxy:e.user.outboundProxy,autoRegister:e.user.autoRegister,registered:e.userStatus.registered}},function(e){return{setDisplayName:function(t){return e(G.j({displayName:t}))},setSipUri:function(t){return e(G.r({sipUri:t}))},setPassword:function(t){return e(G.l({password:t}))},setOutboundProxy:function(t){return e(G.k({outboundProxy:t}))},setAutoRegister:function(t){return e(G.h({autoRegister:t}))}}})(Object(p.withStyles)(function(e){return{paper:{padding:2*e.spacing.unit,width:"20vw"}}})(function(e){var t=e.sipCaller,n=e.displayName,a=e.sipUri,r=e.password,i=e.outboundProxy,o=e.autoRegister,s=e.setDisplayName,c=e.setSipUri,u=e.setPassword,d=e.setOutboundProxy,p=e.setAutoRegister,f=e.registered,m=e.classes;return l.a.createElement(q.a,{className:m.paper},f?l.a.createElement(W.a,{container:!0,spacing:8},l.a.createElement(W.a,{item:!0,xs:12},l.a.createElement(g.a,{variant:"body1",noWrap:!0},n),l.a.createElement(g.a,{noWrap:!0},a),l.a.createElement(g.a,{variant:"caption",noWrap:!0},"Registered")),l.a.createElement(W.a,{item:!0,xs:12},l.a.createElement(H.a,{variant:"contained",color:"secondary",onClick:function(){return t.unRegister()}},"Unregister"))):l.a.createElement(W.a,{container:!0,spacing:8},l.a.createElement(W.a,{item:!0,xs:12},l.a.createElement(B.a,{id:"displayname",label:"Displayname",value:n||"",style:{width:"100%"},onChange:function(e){return s(e.target.value)}})),l.a.createElement(W.a,{item:!0,xs:12},l.a.createElement(B.a,{id:"sipuri",label:"SIP URI",type:"email",value:a||"",style:{width:"100%"},onChange:function(e){return c(e.target.value)}})),l.a.createElement(W.a,{item:!0,xs:12},l.a.createElement(B.a,{id:"password",label:"Password",type:"password",value:r||"",style:{width:"100%"},onChange:function(e){return u(e.target.value)}})),l.a.createElement(W.a,{item:!0,xs:12},l.a.createElement(B.a,{id:"outboundproxy",label:"Outbound Proxy",value:i||"",style:{width:"100%"},onChange:function(e){return d(e.target.value)}})),l.a.createElement(W.a,{item:!0,xs:12},l.a.createElement(J.a,{control:l.a.createElement(X.a,{checked:o,onChange:function(){return p(!o)}}),label:"Autoregister"})),l.a.createElement(W.a,{item:!0,xs:12},l.a.createElement(H.a,{variant:"contained",color:"primary",onClick:function(){return t.register()}},"Register"))))}))),$=n(65),Z=n.n($),ee=n(66),te=n.n(ee),ne=n(84),ae=n.n(ne),re=Object(d.b)(function(e){return{sessionHistory:e.sessionHistory}},function(e){return{setRequestUri:function(t){return e(G.p({requestUri:t}))}}})(Object(p.withStyles)(function(e){return{paper:{padding:2*e.spacing.unit}}})(function(e){var t=e.sessionHistory,n=e.setRequestUri,a=e.classes;return l.a.createElement(q.a,{className:a.paper},t.length>0?l.a.createElement(Z.a,null,t.map(function(e,t){return l.a.createElement(te.a,{key:t,button:!0,onClick:function(){return n(e.sipUri)}},l.a.createElement(ae.a,{primary:e.displayName,secondary:e.sipUri}))})):l.a.createElement(g.a,{color:"inherit",noWrap:!0},"No history"))})),ie=n(17),oe=n(85),se=n.n(oe),ce=n(86),ue=n.n(ce),le=Object(P.b)(Object(d.b)(function(e){return{sessions:e.sessions,currentSession:e.userStatus.currentSession}},function(e){return{setCurrentSession:function(t){return e(G.i({currentSession:t}))}}})(Object(p.withStyles)(function(e){return{paper:{padding:2*e.spacing.unit},iconGreen:{color:"green"},iconRed:{color:"red"}}})(function(e){var t=e.sipCaller,n=e.sessions,a=e.currentSession,r=e.setCurrentSession,i=e.classes;return l.a.createElement(q.a,{className:i.paper},Object.keys(n).length>0?l.a.createElement(Z.a,null,Object.keys(n).map(function(e){var o=n[e],s=o.sipSession,c=s.remoteIdentity.displayName||s.remoteIdentity.uri.user,u=s.remoteIdentity.uri.toString(),d=o.direction===ie.d&&o.sessionState===ie.e;return l.a.createElement(te.a,{key:e,button:!0,selected:e===a,onClick:function(){return r(e)},disabled:o.sessionState===ie.k},l.a.createElement(ae.a,{primary:c,secondary:u}),l.a.createElement(y.a,{className:d?i.iconGreen:i.iconRed,"aria-label":"Answer",onClick:function(){d?t.accept(s):t.terminate(s)}},d?l.a.createElement(se.a,null):l.a.createElement(ue.a,null)))})):l.a.createElement(g.a,{color:"inherit",noWrap:!0},"No sessions"))}))),de=n(43),pe=n(64),fe=n.n(pe),me=Object(P.b)(Object(d.b)(function(e){return{requestUri:e.user.requestUri,registered:e.userStatus.registered}},function(e){return{setRequestUri:function(t){return e(G.p({requestUri:t}))}}})(Object(p.withStyles)(function(e){return{grid:{width:"50vw"},call:Object(c.a)({position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:Object(de.fade)(e.palette.common.white,.15),"&:hover":{backgroundColor:Object(de.fade)(e.palette.common.white,.25)},marginLeft:0,width:"100%"},e.breakpoints.up("sm"),{marginLeft:3*e.spacing.unit,width:"auto"}),callIcon:{width:5*e.spacing.unit,height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},inputRoot:{color:"inherit",width:"100%"},inputInput:Object(c.a)({paddingTop:e.spacing.unit,paddingRight:e.spacing.unit,paddingBottom:e.spacing.unit,paddingLeft:5*e.spacing.unit,transition:e.transitions.create("width"),width:"100%"},e.breakpoints.up("md"),{width:"100%"})}})(function(e){var t=e.sipCaller,n=e.requestUri,a=e.registered,r=e.setRequestUri,i=e.classes;return l.a.createElement(W.a,{className:i.grid,container:!0,spacing:8},l.a.createElement(W.a,{item:!0,xs:9},l.a.createElement("div",{className:i.call},l.a.createElement("div",{className:i.callIcon},l.a.createElement(se.a,null)),l.a.createElement(fe.a,{placeholder:"SIP URI",classes:{root:i.inputRoot,input:i.inputInput},value:n||"",onChange:function(e){return r(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&(e.preventDefault(),t.invite(n))},autoFocus:!0}))),l.a.createElement(W.a,{item:!0,xs:3},l.a.createElement(H.a,{variant:"contained",color:"primary",disabled:!a,onClick:function(){return t.invite(n)}},"Call")))}))),Se=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e)))._mediaStream=null,n}return Object(s.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.classes;return l.a.createElement("video",{className:e.videoView,ref:"video",autoPlay:!0,playsInline:!0})}},{key:"componentDidMount",value:function(){var e=this.props.mediaStream;this._setStream(e)}},{key:"componentWillReceiveProps",value:function(e){var t=e.mediaStream;this._setStream(t)}},{key:"_setStream",value:function(e){if(this._mediaStream!==e){this._mediaStream=e;var t=this.refs.video;t.srcObject=e||null}}}]),t}(u.Component),Ee=Object(p.withStyles)(function(){return{videoView:{objectFit:"cover",width:"100%",height:"100%"}}})(Se),he=n(67),ge=n.n(he),be=n(182),ye=n.n(be),ve=n(181),Oe=n.n(ve),Re=n(180),_e=n.n(Re),Te=n(179),we=n.n(Te),Ie=n(178),Ce=n.n(Ie),je=n(87),ke=n.n(je),Ne=n(88),Ae=n.n(Ne),Me=n(172),Ue=n.n(Me),De=n(173),xe=n.n(De),Pe=n(177),Ge=n.n(Pe),Le=n(175),qe=n.n(Le),Ve=n(176),We=n.n(Ve),Fe=n(174),He=n.n(Fe),ze=function(e){function t(){var e,n;Object(a.a)(this,t);for(var r=arguments.length,s=new Array(r),c=0;c<r;c++)s[c]=arguments[c];return(n=Object(i.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(s)))).state={open:!1},n.handleClickOpen=function(){n.setState({open:!0})},n.handleClose=function(){n.setState({open:!1})},n.handleTransfer=function(){n.handleClose();var e=n.props,t=e.sipCaller,a=e.session,r=e.transferUri;t.refer(a.sipSession,r)},n}return Object(s.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.sipCaller,n=e.session,a=e.transferUri,r=e.setTransferUri,i=e.classes;if(n&&n.sessionState===ie.k){var o=n.sipSession,s=o.remoteIdentity.displayName||o.remoteIdentity.uri.user,c=o.remoteIdentity.uri.toString();return l.a.createElement(ke.a,{className:i.card},l.a.createElement(Ae.a,null,l.a.createElement(g.a,{variant:"h3",noWrap:!0},"Session ended"),l.a.createElement(Ue.a,null),l.a.createElement(g.a,{variant:"h4",noWrap:!0},s),l.a.createElement(g.a,{variant:"h5",noWrap:!0},c)))}return n&&n.remoteStream?l.a.createElement("div",{className:i.sessionView},l.a.createElement(Ee,{mediaStream:n.remoteStream}),l.a.createElement(xe.a,{open:this.state.open,onClose:this.handleClose,"aria-labelledby":"form-dialog-title"},l.a.createElement(He.a,{id:"form-dialog-title"},"Transfer session"),l.a.createElement(qe.a,null,l.a.createElement(We.a,null,"To transfer this session, type the SIP URI you want to transfer to below."),l.a.createElement(B.a,{autoFocus:!0,margin:"dense",id:"sipUri",label:"SIP URI",type:"email",value:a||"",onChange:function(e){return r(e.target.value)},fullWidth:!0})),l.a.createElement(Ge.a,null,l.a.createElement(H.a,{onClick:this.handleClose,color:"primary"},"Cancel"),l.a.createElement(H.a,{onClick:this.handleTransfer,color:"primary"},"Transfer"))),l.a.createElement("div",{className:i.buttonList},l.a.createElement(ge.a,{className:i.button,"aria-label":"Audio on/off",size:"large",onClick:function(){return t.toggleMedia(n.sipSession,"audio",!n.remoteAudioMuted)}},n.remoteAudioMuted?l.a.createElement(Ce.a,null):l.a.createElement(we.a,null)),l.a.createElement(ge.a,{className:i.button,"aria-label":"Video on/off",size:"large",onClick:function(){return t.toggleMedia(n.sipSession,"video",!n.remoteVideoMuted)}},n.remoteVideoMuted?l.a.createElement(_e.a,null):l.a.createElement(Oe.a,null)),l.a.createElement(ge.a,{className:i.button,"aria-label":"Video on/off",size:"large",onClick:this.handleClickOpen},l.a.createElement(ye.a,null)),l.a.createElement(ge.a,{color:"secondary",className:i.button,"aria-label":"Hang up",size:"large",onClick:function(){return t.terminate(n.sipSession)}},l.a.createElement(ue.a,null)))):null}}]),t}(u.Component),Be=Object(P.b)(Object(d.b)(function(e){return{session:e.sessions[e.userStatus.currentSession],transferUri:e.user.transferUri}},function(e){return{setTransferUri:function(t){return e(G.s({transferUri:t}))}}})(Object(p.withStyles)(function(e){return{button:{margin:e.spacing.unit},buttonList:{position:"absolute",bottom:"1vh",transform:"translate(-50%, 0)",left:"50%"},card:{position:"absolute",bottom:"50vh",transform:"translate(-50%, 0)",left:"50%",textAlign:"center"},sessionView:{position:"absolute",width:"100%",height:"100%",textAlign:"center"}}})(ze))),Ye=n(57),Je=n(82),Qe=function(e){function t(){var e,n;Object(a.a)(this,t);for(var r=arguments.length,s=new Array(r),c=0;c<r;c++)s[c]=arguments[c];return(n=Object(i.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(s)))).displayed=[],n.storeDisplayed=function(e){n.displayed=[].concat(Object(Ye.a)(n.displayed),[e])},n}return Object(s.a)(t,e),Object(r.a)(t,[{key:"shouldComponentUpdate",value:function(e){for(var t=e.notifications,n=void 0===t?[]:t,a=this.props.notifications,r=!1,i=function(e){if(r)return"continue";r=r||!a.filter(function(t){var a=t.id;return n[e].id===a}).length},o=0;o<n.length;o+=1)i(o);return r}},{key:"componentDidUpdate",value:function(){var e=this,t=this.props.notifications;(void 0===t?[]:t).forEach(function(t){e.displayed.includes(t.id)||(e.props.enqueueSnackbar(t.text,{variant:t.type,autoHideDuration:t.timeout,anchorOrigin:{vertical:"bottom",horizontal:"left"}}),e.storeDisplayed(t.id),e.props.removeNotification(t.id))})}},{key:"render",value:function(){return null}}]),t}(u.Component),Xe=Object(Je.withSnackbar)(Object(d.b)(function(e){return{notifications:e.notifications}},function(e){return{removeNotification:function(t){return e(G.f(t))}}})(Qe)),Ke=n(183),$e=n.n(Ke),Ze=n(184),et=n.n(Ze),tt=Object(P.b)(Object(d.b)(function(e){return{incomingSessions:Object.values(e.sessions).filter(function(e){return e.sessionState===ie.e&&e.direction===ie.d})}},null)(Object(p.withStyles)({container:{position:"fixed",top:0,right:0,bottom:0,padding:20,display:"flex",flexDirection:"column",justifyContent:"flex-end",alignItems:"flex-end",transition:"right 0.3s"},card:{width:300,marginTop:5}})(function(e){var t=e.sipCaller,n=e.incomingSessions,a=e.classes;return l.a.createElement("div",{className:a.container},n.map(function(e){return l.a.createElement(ke.a,{key:e.sipSession.request.callId,className:a.card},l.a.createElement($e.a,null,l.a.createElement(Ae.a,null,l.a.createElement(g.a,{gutterBottom:!0,variant:"h6",component:"h2"},"Incoming call"),l.a.createElement(g.a,{component:"p",noWrap:!0},e.sipSession.remoteIdentity.displayName||e.sipSession.remoteIdentity.uri.user))),l.a.createElement(et.a,null,l.a.createElement(H.a,{size:"small",color:"primary",onClick:function(){return t.accept(e.sipSession)}},"Answer"),l.a.createElement(H.a,{size:"small",color:"primary",onClick:function(){return t.terminate(e.sipSession)}},"Decline")))}))}))),nt=function(e){function t(){var e,n;Object(a.a)(this,t);for(var r=arguments.length,s=new Array(r),c=0;c<r;c++)s[c]=arguments[c];return(n=Object(i.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(s)))).state={anchorEl:null,mobileMoreAnchorEl:null,currentMenu:null},n.handleExited=function(){n.setState({currentMenu:null})},n.handleMenuOpen=function(e,t){n.setState({anchorEl:e.currentTarget,currentMenu:t})},n.handleMenuClose=function(){n.setState({anchorEl:null}),n.handleMobileMenuClose()},n.handleMobileMenuOpen=function(e){n.setState({mobileMoreAnchorEl:e.currentTarget})},n.handleMobileMenuClose=function(){n.setState({mobileMoreAnchorEl:null})},n}return Object(s.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.anchorEl,a=t.mobileMoreAnchorEl,r=t.currentMenu,i=this.props,o=i.sessions,s=i.classes,c=Boolean(n),u=Boolean(a);return l.a.createElement("div",{className:s.root},l.a.createElement(Be,null),l.a.createElement(Xe,null),l.a.createElement(tt,null),l.a.createElement(m.a,{position:"static",style:{background:"transparent",boxShadow:"none"}},l.a.createElement(E.a,null,l.a.createElement(g.a,{className:s.title,variant:"h6",color:"inherit",noWrap:!0},"SipCaller"),l.a.createElement(me,null),l.a.createElement("div",{className:s.grow}),l.a.createElement("div",{className:s.sectionDesktop},l.a.createElement(y.a,{"aria-owns":c&&"sessions"===r?"material-appbar":void 0,"aria-haspopup":"true",onClick:function(t){return e.handleMenuOpen(t,"sessions")},color:"inherit"},l.a.createElement(O.a,{badgeContent:o,color:"secondary"},l.a.createElement(A.a,null))),l.a.createElement(y.a,{"aria-owns":c&&"history"===r?"material-appbar":void 0,"aria-haspopup":"true",onClick:function(t){return e.handleMenuOpen(t,"history")},color:"inherit"},l.a.createElement(U.a,null)),l.a.createElement(y.a,{"aria-owns":c&&"account"===r?"material-appbar":void 0,"aria-haspopup":"true",onClick:function(t){return e.handleMenuOpen(t,"account")},color:"inherit"},l.a.createElement(k.a,null))),l.a.createElement("div",{className:s.sectionMobile},l.a.createElement(y.a,{"aria-haspopup":"true",onClick:this.handleMobileMenuOpen,color:"inherit"},l.a.createElement(x.a,null))))),l.a.createElement(C.a,{anchorEl:n,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},open:c,onClose:this.handleMenuClose,onExited:this.handleExited,getContentAnchorEl:null},"sessions"===r?l.a.createElement(le,null):null,"history"===r?l.a.createElement(re,null):null,"account"===r?l.a.createElement(K,null):null),l.a.createElement(w.a,{anchorEl:a,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"bottom",horizontal:"right"},open:u,onClose:this.handleMenuClose,getContentAnchorEl:null},l.a.createElement(_.a,{onClick:function(t){return e.handleMenuOpen(t,"sessions")}},l.a.createElement(y.a,{color:"inherit"},l.a.createElement(O.a,{badgeContent:o,color:"secondary"},l.a.createElement(A.a,null))),l.a.createElement("p",null,"Sessions")),l.a.createElement(_.a,{onClick:function(t){return e.handleMenuOpen(t,"history")}},l.a.createElement(y.a,{color:"inherit"},l.a.createElement(U.a,null)),l.a.createElement("p",null,"Call log")),l.a.createElement(_.a,{onClick:function(t){return e.handleMenuOpen(t,"account")}},l.a.createElement(y.a,{color:"inherit"},l.a.createElement(k.a,null)),l.a.createElement("p",null,"Account"))))}}]),t}(u.Component);t.a=Object(d.b)(function(e){return{sessions:Object.keys(e.sessions).length}},null)(Object(p.withStyles)(function(e){return{root:{width:"100%",height:"100%"},grow:{flexGrow:1},title:Object(c.a)({display:"none"},e.breakpoints.up("sm"),{display:"block"}),sectionDesktop:Object(c.a)({display:"none"},e.breakpoints.up("md"),{display:"flex"}),sectionMobile:Object(c.a)({display:"flex"},e.breakpoints.up("md"),{display:"none"})}})(nt))},193:function(e,t,n){e.exports=n(194)},194:function(e,t,n){"use strict";n.r(t),function(e){var t=n(163),a=n.n(t),r=n(0),i=n.n(r),o=n(26),s=n.n(o),c=n(21),u=n(165),l=n(91),d=n(82),p=(n(47),n(83)),f=n(30),m=(n(286),n(192)),S=n(189),E=n(190),h=n(112);var g,b=new p.a;h.a.init({store:l.b}),a()(function(){b.debug("DOM ready"),b.debug("run() [environment:%s]","production"),g=new h.a,e.sipCaller=g,s.a.render(i.a.createElement(c.a,{store:l.b},i.a.createElement(u.PersistGate,{loading:i.a.createElement(S.a,null),persistor:l.a},i.a.createElement(f.a.Provider,{value:g},i.a.createElement(d.SnackbarProvider,null,i.a.createElement(m.a,null))))),document.getElementById("sipcaller"))}),E.a()}.call(this,n(32))},286:function(e,t,n){},30:function(e,t,n){"use strict";n.d(t,"b",function(){return o});var a=n(0),r=n.n(a),i=r.a.createContext();t.a=i;var o=function(e){return function(t){return r.a.createElement(i.Consumer,null,function(n){return r.a.createElement(e,Object.assign({},t,{sipCaller:n}))})}}},377:function(e,t,n){},7:function(e,t,n){"use strict";n.d(t,"j",function(){return a}),n.d(t,"r",function(){return r}),n.d(t,"l",function(){return i}),n.d(t,"k",function(){return o}),n.d(t,"p",function(){return s}),n.d(t,"s",function(){return c}),n.d(t,"h",function(){return u}),n.d(t,"n",function(){return l}),n.d(t,"m",function(){return d}),n.d(t,"o",function(){return p}),n.d(t,"d",function(){return f}),n.d(t,"g",function(){return m}),n.d(t,"c",function(){return S}),n.d(t,"a",function(){return E}),n.d(t,"t",function(){return h}),n.d(t,"u",function(){return g}),n.d(t,"q",function(){return b}),n.d(t,"i",function(){return y}),n.d(t,"e",function(){return v}),n.d(t,"b",function(){return O}),n.d(t,"f",function(){return R});var a=function(e){var t=e.displayName;return function(e){e({type:"SET_DISPLAY_NAME",payload:{displayName:t}})}},r=function(e){var t=e.sipUri;return function(e){e({type:"SET_SIP_URI",payload:{sipUri:t}})}},i=function(e){var t=e.password;return function(e){e({type:"SET_PASSWORD",payload:{password:t}})}},o=function(e){var t=e.outboundProxy;return function(e){e({type:"SET_OUTBOUND_PROXY",payload:{outboundProxy:t}})}},s=function(e){var t=e.requestUri;return function(e){e({type:"SET_REQUEST_URI",payload:{requestUri:t}})}},c=function(e){var t=e.transferUri;return function(e){e({type:"SET_TRANSFER_URI",payload:{transferUri:t}})}},u=function(e){var t=e.autoRegister;return function(e){e({type:"SET_AUTO_REGISTER",payload:{autoRegister:t}})}},l=function(e){var t=e.registered;return function(e){e({type:"SET_REGISTERED",payload:{registered:t}})}},d=function(){return function(e){e({type:"SET_REGISTER_IN_PROGRESS"})}},p=function(e){var t=e.registrationMessage;return function(e){e({type:"SET_REGISTRATION_MESSAGE",payload:{registrationMessage:t}})}},f=function(e){var t=e.sipSession,n=e.direction;return function(e){e({type:"ADD_SESSION",payload:{sipSession:t,direction:n}})}},m=function(e){var t=e.sipSession;return function(e){e({type:"REMOVE_SESSION",payload:{sipSession:t}})}},S=function(e){var t=e.sipSession,n=e.remoteStream;return function(e){e({type:"ADD_REMOTE_STREAM",payload:{sipSession:t,remoteStream:n}})}},E=function(e){var t=e.sipSession,n=e.localStream;return function(e){e({type:"ADD_LOCAL_STREAM",payload:{sipSession:t,localStream:n}})}},h=function(e){var t=e.sipSession;return function(e){e({type:"TOGGLE_REMOTE_AUDIO",payload:{sipSession:t}})}},g=function(e){var t=e.sipSession;return function(e){e({type:"TOGGLE_REMOTE_VIDEO",payload:{sipSession:t}})}},b=function(e){var t=e.sipSession,n=e.sessionState;return function(e){e({type:"SET_SESSION_STATE",payload:{sipSession:t,sessionState:n}})}},y=function(e){var t=e.currentSession;return function(e){e({type:"SET_CURRENT_SESSION",payload:{currentSession:t}})}},v=function(e){var t=e.displayName,n=e.sipUri,a=e.direction,r=e.startTime;return function(e){e({type:"ADD_SESSION_ENTRY",payload:{displayName:t,sipUri:n,direction:a,startTime:r}})}},O=function(e){return{type:"ADD_NOTIFICATION",payload:{notification:e}}},R=function(e){return{type:"REMOVE_NOTIFICATION",payload:{notificationId:e}}}},83:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var a=n(29),r=n(27),i=n(47),o=n.n(i),s="sipcaller",c=function(){function e(t){Object(a.a)(this,e),t?(this._debug=o()("".concat(s,":").concat(t)),this._warn=o()("".concat(s,":WARN:").concat(t)),this._error=o()("".concat(s,":ERROR:").concat(t))):(this._debug=o()(s),this._warn=o()("".concat(s,":WARN")),this._error=o()("".concat(s,":ERROR"))),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}return Object(r.a)(e,[{key:"debug",get:function(){return this._debug}},{key:"warn",get:function(){return this._warn}},{key:"error",get:function(){return this._error}}]),e}()},91:function(e,t,n){"use strict";var a=n(35),r=n(166),i=(n(203),n(111)),o=n(167),s=n.n(o),c=n(168),u=n.n(c),l=n(10),d={displayName:null,sipUri:null,password:null,outboundProxy:null,autoRegister:!1,videoEnabled:!0,requestUri:null,transferUri:null},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":var n=t.payload,a=n.displayName,r=n.sipUri,i=n.password,o=n.outboundProxy,s=n.autoRegister;return Object(l.a)({},e,{displayName:a,sipUri:r,password:i,outboundProxy:o,autoRegister:s});case"SET_DISPLAY_NAME":var c=t.payload.displayName;return Object(l.a)({},e,{displayName:c});case"SET_SIP_URI":var u=t.payload.sipUri;return Object(l.a)({},e,{sipUri:u});case"SET_PASSWORD":var p=t.payload.password;return Object(l.a)({},e,{password:p});case"SET_OUTBOUND_PROXY":var f=t.payload.outboundProxy;return Object(l.a)({},e,{outboundProxy:f});case"SET_AUTO_REGISTER":var m=t.payload.autoRegister;return Object(l.a)({},e,{autoRegister:m});case"TOGGLE_VIDEO":var S=!e.videoEnabled;return Object(l.a)({},e,{videoEnabled:S});case"SET_REQUEST_URI":var E=t.payload.requestUri;return Object(l.a)({},e,{requestUri:E});case"SET_TRANSFER_URI":var h=t.payload.transferUri;return Object(l.a)({},e,{transferUri:h});default:return e}},f=n(31),m=n(169),S=n.n(m),E={sipSession:null,direction:null,remoteStream:null,remoteAudioMuted:!1,remoteVideoMuted:!1,localStream:null,localAudioMuted:!1,localVideoMuted:!1,sessionState:n(17).e},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_SESSION":var n=t.payload,a=n.sipSession,r=n.direction;return Object(l.a)({},e,{sipSession:a,direction:r});case"ADD_REMOTE_STREAM":var i=t.payload.remoteStream;return Object(l.a)({},e,{remoteStream:i});case"ADD_LOCAL_STREAM":var o=t.payload.localStream;return Object(l.a)({},e,{localStream:o});case"SET_SESSION_STATE":var s=t.payload.sessionState;return Object(l.a)({},e,{sessionState:s});case"TOGGLE_LOCAL_AUDIO":var c=!e.localAudioMuted;return Object(l.a)({},e,{localAudioMuted:c});case"TOGGLE_LOCAL_VIDEO":var u=!e.localVideoMuted;return Object(l.a)({},e,{localVideoMuted:u});case"TOGGLE_REMOTE_AUDIO":var d=!e.remoteAudioMuted;return Object(l.a)({},e,{remoteAudioMuted:d});case"TOGGLE_REMOTE_VIDEO":var p=!e.remoteVideoMuted;return Object(l.a)({},e,{remoteVideoMuted:p});default:return e}},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_SESSION":var n=t.payload.sipSession.request.callId;return Object(l.a)({},e,Object(f.a)({},n,h(void 0,t)));case"REMOVE_SESSION":var a=t.payload.sipSession.request.callId;return S()(e,a);case"TOGGLE_LOCAL_AUDIO":case"TOGGLE_LOCAL_VIDEO":case"TOGGLE_REMOTE_AUDIO":case"TOGGLE_REMOTE_VIDEO":case"ADD_REMOTE_STREAM":case"ADD_LOCAL_STREAM":case"SET_SESSION_STATE":var r=t.payload.sipSession.request.callId,i=e[r];if(!i)throw new Error("No session found");return Object(l.a)({},e,Object(f.a)({},r,h(i,t)));default:return e}},b=n(57),y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_SESSION_ENTRY":var n=t.payload,a=n.displayName,r=n.sipUri,i=n.direction,o=n.startTime;return[].concat(Object(b.a)(e),[{displayName:a,sipUri:r,direction:i,startTime:o}]);case"CLEAR_SESSION_HISTORY":return[];default:return e}},v={registerInProgress:!1,registered:!1,registrationMessage:null,currentSession:null},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_REGISTERED":var n=t.payload.registered;return Object(l.a)({},e,{registered:n,registerInProgress:!1});case"SET_REGISTRATION_MESSAGE":var a=t.payload.registrationMessage;return Object(l.a)({},e,{registrationMessage:a});case"SET_REGISTER_IN_PROGRESS":return Object(l.a)({},e,{registerInProgress:!0});case"ADD_SESSION":var r=t.payload.sipSession.request.callId;return e.currentSession?e:Object(l.a)({},e,{currentSession:r});case"REMOVE_SESSION":var i=t.payload.sipSession.request.callId;return e.currentSession===i?Object(l.a)({},e,{currentSession:null}):e;case"SET_CURRENT_SESSION":var o=t.payload.currentSession;return Object(l.a)({},e,{currentSession:o});default:return e}},R=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_NOTIFICATION":var n=t.payload.notification;return[].concat(Object(b.a)(e),[n]);case"REMOVE_NOTIFICATION":var a=t.payload.notificationId;return e.filter(function(e){return e.id!==a});case"REMOVE_ALL_NOTIFICATIONS":return[];default:return e}},_=Object(a.c)({user:p,sessions:g,sessionHistory:y,userStatus:O,notifications:R});n.d(t,"b",function(){return C}),n.d(t,"a",function(){return j});var T={key:"root",storage:s.a,stateReconciler:u.a,blacklist:["sessions","userStatus"]},w=[r.a],I=Object(i.a)(T,_),C=Object(a.d)(I,a.a.apply(void 0,w)),j=Object(i.b)(C)}},[[193,2,1]]]);
//# sourceMappingURL=main.410ce508.chunk.js.map